/*!
 * Neo-Chart.js
 * https://github.com/WolfgangKurz/Neo-Chart
 * Version: 1.0.13
 *
 * Copyright 2016-2018 Wolfgang Kurz
 * Released under the MIT license
 * https://github.com/WolfgangKurz/Neo-Chart/blob/master/LICENSE
 */
"use strict";!function(){var t=function(t){return document.querySelector(t)};t.find=function(t,e){return t.querySelector(e)},HTMLElement.prototype.find=function(t){return this.querySelector(t)},HTMLElement.prototype.attr=function(t,e){return void 0===e?this.getAttribute(t):(this.setAttribute(t,e),this)},window.neoChart=function(e){var a=e.getContext("2d"),r=t("."+e.attr("data-target")),l={index:-1,baseX:0,cellWidth:0},s={title:e.attr("data-title")?e.attr("data-title"):"",font:e.attr("data-font")?e.attr("data-font"):"12px Arial",popupFont:e.attr("data-popup-font")?e.attr("data-popup-font"):"bold 12px Arial",titleFont:e.attr("data-title-font")?e.attr("data-title-font"):"bold 16px Arial",background:e.attr("data-background")?e.attr("data-background"):"#FFFFFF",gridVertColor:e.attr("data-vert-grid-color")?e.attr("data-vert-grid-color"):"#e8e8e8",gridHorzColor:e.attr("data-horz-grid-color")?e.attr("data-horz-grid-color"):"#b6b6b6",baselineColor:e.attr("data-baseline-color")?e.attr("data-baseline-color"):"#b6b6b6",labels:r.find(".chart-data-label").value.split(","),style:e.attr("data-style")?e.attr("data-style").split(","):["line"],"x-prefix":e.attr("data-x-prefix")?e.attr("data-x-prefix"):"","x-postfix":e.attr("data-x-postfix")?e.attr("data-x-postfix"):"","y-prefix":e.attr("data-y-prefix")?e.attr("data-y-prefix"):"","y-postfix":e.attr("data-y-postfix")?e.attr("data-y-postfix"):"","bar-y-prefix":e.attr("data-bar-y-prefix")?e.attr("data-bar-y-prefix"):"","bar-y-postfix":e.attr("data-bar-y-postfix")?e.attr("data-bar-y-postfix"):"",min:e.attr("data-min")?parseInt(e.attr("data-min")):0,max:e.attr("data-min")?parseInt(e.attr("data-max")):100,bars:e.attr("data-bars")?parseInt(e.attr("data-bars")):1,splits:e.attr("data-split")?parseInt(e.attr("data-split")):parseInt(e.height/36),type:e.attr("data-type")};s["bar-min"]=e.attr("data-bar-min")?parseInt(e.attr("data-bar-min")):s.min,s["bar-max"]=e.attr("data-bar-max")?parseInt(e.attr("data-bar-max")):s.max;for(var i=0;i<s.style.length;i++){for(var o=[],n=[],f=[],d=0;;d++){var h=r.find(".chart-data-"+s.style[i]+"-dataset"+d);if(null==h)break;var b=[];h=h.value.split(",");for(var p=0;p<h.length;p++)if(h[p].toString().indexOf(";")>=0){for(var x=h[p].toString().split(";"),c=0;c<x.length;c++)x[c]=parseFloat(x[c]);b.push(x)}else b.push(parseFloat(h[p]));o.push(b);var y=r.find(".chart-data-"+s.style[i]+"-color"+d).value.split(",");f.push(y);var g=r.find(".chart-data-"+s.style[i]+"-dataname"+d).value.split(",");n.push(g)}s[s.style[i]+"-dataset"]=o,s[s.style[i]+"-names"]=n,s[s.style[i]+"-colors"]=f}var m=["bar","line"],u=[];for(d=0;d<m.length;d++){for(p=0;p<s.style.length;p++)if(!(u.indexOf(s.style[p])>=0)&&m[d]==s.style[p]){u.push(s.style[p]);break}for(p=0;p<s.style.length;p++)u.indexOf(s.style[p])>=0||u.push(s.style[p])}s.style=u;var v=function(){var t,r,i,o,n,f,d=e.width,h=e.height,b=s.max-s.min,p=s["bar-max"]-s["bar-min"],x=0,c=0,y=function(t){return s["x-prefix"]+t+s["x-postfix"]},g=function(t){return s["y-prefix"]+(isNaN(t)?"-":t)+s["y-postfix"]},m=function(t){return s["bar-y-prefix"]+(isNaN(t)?"-":t)+s["bar-y-postfix"]};a.setTransform(1,0,0,1,0,0),a.lineWidth=.9,a.fillStyle=s.background,a.clearRect(0,0,d,h),a.fillRect(0,0,d,h),a.translate(.5,.5),a.font=s.font,n=a.measureText(g(s.max)),i=t=parseInt(n.width),o=d-parseInt(t),i+=parseInt(o/s.labels.length/2),o-=t,n=a.measureText(y(s.labels[0])),r=18;for(var u=0;u<s.style.length;u++){if("bar"==s.style[u])c=(v=parseInt(o/s.labels.length/2))/s.bars,n=a.measureText(m(s["bar-max"])),i-=4,d-=(x=parseInt(n.width))+8,o-=x+14}l.baseX=8+t+4+8,l.cellWidth=o/s.labels.length,l.bottom=h-8-r-8,l.top=8,s.title.length>0&&(a.translate(0,20),l.top+=20,h-=20,a.fillStyle="#7c7c7c",a.font=s.titleFont,n=a.measureText(s.title),a.fillText(s.title,d/2-n.width/2,0)),a.font=s.font,a.fillStyle="#8c8c8c",a.strokeStyle=s.gridHorzColor;for(u=0;u<s.labels.length;u++){if(l.index==u){a.fillStyle="rgba(212,212,212,0.17)";var v=parseInt(o*u-o/2)/s.labels.length;a.fillRect(8+i+4+8+v,8,o/s.labels.length-2,h-8-r-8-8),a.fillStyle="#8c8c8c"}v=y(s.labels[u]);f=(n=a.measureText(v)).width,a.fillText(v,8+i+4+8+o*u/s.labels.length-f/2,h-r+4),v=parseInt((o*u+o/2)/s.labels.length),a.strokeStyle=s.gridVertColor,a.beginPath(),a.moveTo(8+i+4+8+v,12),a.lineTo(8+i+4+8+v,h-8-r-8),a.closePath(),a.stroke(),a.strokeStyle=s.gridHorzColor,a.beginPath(),a.moveTo(8+i+4+8+v,h-8-r-8),a.lineTo(8+i+4+8+v,h-8-r),a.closePath(),a.stroke()}a.beginPath();for(u=0;u<s.splits+1;u++){var T=g(s.max-parseInt((s.max-s.min)*u/s.splits));if(f=(n=a.measureText(T)).width,a.fillText(T,8+t-f,8+(h-8-r)*u/(s.splits+1)+18),u<s.splits&&(T=parseInt((h-8-r)*u/(s.splits+1)),a.moveTo(8+t+4,8+T+14),a.lineTo(d-12,8+T+14)),x>0){T=m(s["bar-max"]-parseInt((s["bar-max"]-s["bar-min"])*u/s.splits));a.fillText(T,d-8,8+(h-8-r)*u/(s.splits+1)+18)}}a.closePath(),a.stroke(),a.strokeStyle=s.baselineColor,a.beginPath(),a.moveTo(8+t+4,h-8-r-8),a.lineTo(d-12,h-8-r-8),a.closePath(),a.stroke(),a.beginPath(),a.moveTo(8+t+4+8,12),a.lineTo(8+t+4+8,h-8-r),x>0&&(a.moveTo(d-8-8-4,12),a.lineTo(d-8-8-4,h-8-r)),a.closePath(),a.stroke();var w=0;a.font=s.popupFont;for(var I=0;I<s.style.length;I++)switch(s.style[I]){case"line":a.lineWidth=1.3;for(u=0;u<s["line-dataset"].length;u++){var S=s["line-dataset"][u];a.strokeStyle=s["line-colors"][u],a.beginPath();for(var k=0;k<S.length;k++){T=(h-r-38)*S[k]/b;0==k?a.moveTo(8+i+4+8+parseInt(o*k/s.labels.length),h-8-r-8-T):a.lineTo(8+i+4+8+parseInt(o*k/s.labels.length),h-8-r-8-T)}a.stroke()}for(u=0;u<s["line-dataset"].length;u++)for(S=s["line-dataset"][u],k=0;k<S.length;k++){v=8+i+4+8+parseInt(o*k/s.labels.length),T=(h-r-38)*S[k]/b;a.lineWidth=1.78,a.strokeStyle=s["line-colors"][u],a.beginPath(),a.arc(v,h-8-r-8-T,3,0,2*Math.PI,!0),a.closePath(),a.stroke(),a.lineWidth=1.3,a.strokeStyle="#FFFFFF",a.beginPath(),a.arc(v,h-8-r-8-T,4.3,0,2*Math.PI,!0),a.closePath(),a.stroke(),a.fillStyle=s["line-colors"][u],a.save(),n=a.measureText(g(S[k])),a.shadowColor="rgba(0, 0, 0, 0.17)",a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=7,w=Math.max(n.width,w);var F=h-8-r-8-T+12+8;F+10>h-8-r-8&&(F-=28),a.fillText(g(S[k]),v-parseInt(n.width/2),F),a.restore()}break;case"bar":a.lineWidth=.9;for(u=0;u<s["bar-dataset"].length;u++){S=s["bar-dataset"][u];a.strokeStyle="#727272";for(k=0;k<S.length;k++){v=8+i+4+8+parseInt(o*k/s.labels.length);if("object"==typeof S[k])for(var P=0;P<Math.min(S[k].length,s.bars);P++){a.fillStyle=s["bar-colors"][u][P];T=(h-r-38)*S[k][P]/p;a.fillRect(v-c/2*s.bars+P*c,h-8-r-8-T,c,T),a.strokeRect(v-c/2*s.bars+P*c,h-8-r-8-T,c,T),n=a.measureText(S[k][P]),w=Math.max(n.width,w)}else{a.fillStyle=s["bar-colors"][k][0];T=(h-r-38)*S[k]/p;a.fillRect(v-c/2*s.bars,h-8-r-8-T,c,T),a.strokeRect(v-c/2*s.bars,h-8-r-8-T,c,T),n=a.measureText(S[k]),w=Math.max(n.width,w)}}}}w=parseInt(w);var M=0,C=32,R=18,W=0;for(I=0;I<s.style.length;I++){S=s[s.style[I]+"-dataset"];S=s[s.style[I]+"-names"];for(var O=0;O<S.length;O++)if("object"==typeof S[O]){for(u=0;u<S[O].length;u++)n=a.measureText(S[O][u]),W=Math.max(parseInt(n.width),W);C+=16*S[O].length}else n=a.measureText(S[O]),W=Math.max(parseInt(n.width),W),C+=16*S.length;switch(s.style[I]){case"line":for(u=0;u<s["line-dataset"].length;u++)for(S=s["line-dataset"][u],O=0;O<S.length;O++)if("object"==typeof S[O])for(P=0;P<S[O].length;P++)n=a.measureText(g(S[O][P])),M=Math.max(parseInt(n.width),M);else n=a.measureText(g(S[O])),M=Math.max(parseInt(n.width),M);break;case"bar":for(u=0;u<s["bar-dataset"].length;u++)for(S=s["bar-dataset"][u],O=0;O<S.length;O++)if("object"==typeof S[O])for(P=0;P<Math.min(S[O].length,s.bars);P++)n=a.measureText(g(S[O][P])),M=Math.max(parseInt(n.width),M);else n=a.measureText(g(S[O])),M=Math.max(parseInt(n.width),M)}}M+=(W+=8)+18;for(O=0;O<s.labels.length;O++)if(l.index==O){a.fillStyle="#FFFFFF",a.strokeStyle="#959595";v=parseInt((o*O+o/1.5)/s.labels.length);(v+=8+i+4+8)+M>=d-20&&(v-=parseInt(o/s.labels.length)+M+32),a.save(),a.shadowColor="rgba(0, 0, 0, 0.43)",a.shadowOffsetX=0,a.shadowOffsetY=2,a.shadowBlur=4,a.strokeRect(v,72,M,C),a.restore(),a.fillRect(v,72,M,C),a.fillStyle="#383838",n=a.measureText(s.labels[O]),a.fillText(s.labels[O],v+parseInt(M/2-n.width/2),72+R),R+=20;for(I=0;I<s.style.length;I++)switch(s.style[I]){case"line":for(u=0;u<s["line-dataset"].length;u++){S=s["line-dataset"][u];a.fillStyle="#383838",a.fillText(s["line-names"][u],v+8,72+R),a.fillStyle=s["line-colors"][u],a.fillText(g(S[O]),W+v+8,72+R),R+=16}break;case"bar":a.lineWidth=.9;for(u=0;u<s["bar-dataset"].length;u++){S=s["bar-dataset"][u];if(a.strokeStyle="#727272","object"==typeof S[O])for(P=0;P<Math.min(S[O].length,s.bars);P++)a.fillStyle="#383838",a.fillText(s["bar-names"][u][P],v+8,72+R),a.fillStyle=s["bar-colors"][u][P],a.fillText(m(S[O][P]),W+v+8,72+R),R+=16;else a.fillStyle="#383838",a.fillText(s["bar-names"][O],v+8,72+R),a.fillStyle=s["bar-colors"][O][0],a.fillText(m(S[O]),W+v+8,72+R),R+=16}}}},T=function(){var t=window.getComputedStyle(e.parentNode,null);e.width=parseInt(t.getPropertyValue("width")),v()};e.addEventListener("mousemove",function(t){var e=l.index;t.offsetY<l.top?l.index=-1:t.offsetY>=l.bottom?l.index=-1:(l.index=Math.floor((t.offsetX-l.baseX)/l.cellWidth),l.index<0?l.index=-1:l.index>=s.labels.length&&(l.index=-1)),e!=l.index&&v()}),e.addEventListener("mouseleave",function(t){l.index=-1,v()}),window.addEventListener("resize",T),T()}}()
