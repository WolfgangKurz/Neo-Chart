/*!
 * Neo-Chart.js
 * https://github.com/WolfgangKurz/Neo-Chart
 * Version: 1.0.14
 *
 * Copyright 2016-2018 Wolfgang Kurz
 * Released under the MIT license
 * https://github.com/WolfgangKurz/Neo-Chart/blob/master/LICENSE
 */
"use strict";!function(){var m=function(t){return document.querySelector(t)};m.find=function(t,e){return t.querySelector(e)},HTMLElement.prototype.find=function(t){return this.querySelector(t)},HTMLElement.prototype.attr=function(t,e){return void 0===e?this.getAttribute(t):(this.setAttribute(t,e),this)},window.neoChart=function(C){var R=C.getContext("2d"),t=m("."+C.attr("data-target")),W={index:-1,baseX:0,cellWidth:0},O={title:C.attr("data-title")?C.attr("data-title"):"",font:C.attr("data-font")?C.attr("data-font"):"12px Arial",popupFont:C.attr("data-popup-font")?C.attr("data-popup-font"):"bold 12px Arial",titleFont:C.attr("data-title-font")?C.attr("data-title-font"):"bold 16px Arial",background:C.attr("data-background")?C.attr("data-background"):"#FFFFFF",gridVertColor:C.attr("data-vert-grid-color")?C.attr("data-vert-grid-color"):"#e8e8e8",gridHorzColor:C.attr("data-horz-grid-color")?C.attr("data-horz-grid-color"):"#b6b6b6",baselineColor:C.attr("data-baseline-color")?C.attr("data-baseline-color"):"#b6b6b6",labels:t.find(".chart-data-label").value.split(","),style:C.attr("data-style")?C.attr("data-style").split(","):["line"],"x-prefix":C.attr("data-x-prefix")?C.attr("data-x-prefix"):"","x-postfix":C.attr("data-x-postfix")?C.attr("data-x-postfix"):"","y-prefix":C.attr("data-y-prefix")?C.attr("data-y-prefix"):"","y-postfix":C.attr("data-y-postfix")?C.attr("data-y-postfix"):"","bar-y-prefix":C.attr("data-bar-y-prefix")?C.attr("data-bar-y-prefix"):"","bar-y-postfix":C.attr("data-bar-y-postfix")?C.attr("data-bar-y-postfix"):"",min:C.attr("data-min")?parseInt(C.attr("data-min")):0,max:C.attr("data-min")?parseInt(C.attr("data-max")):100,bars:C.attr("data-bars")?parseInt(C.attr("data-bars")):1,splits:C.attr("data-split")?parseInt(C.attr("data-split")):parseInt(C.height/36),type:C.attr("data-type")};O["bar-min"]=C.attr("data-bar-min")?parseInt(C.attr("data-bar-min")):O.min,O["bar-max"]=C.attr("data-bar-max")?parseInt(C.attr("data-bar-max")):O.max;for(var e=0;e<O.style.length;e++){for(var a=[],l=[],r=[],s=[],i=0;;i++){var o=t.find(".chart-data-"+O.style[e]+"-dataset"+i);if(null==o)break;var n=[];o=o.value.split(",");for(var f=0;f<o.length;f++)if(0<=o[f].toString().indexOf(";")){for(var d=o[f].toString().split(";"),h=0;h<d.length;h++)d[h]=parseFloat(d[h]);n.push(d)}else n.push(parseFloat(o[f]));a.push(n);var p=t.find(".chart-data-"+O.style[e]+"-color"+i).value.split(",");r.push(p),null!=(p=t.find(".chart-data-"+O.style[e]+"-text-color"+i))&&s.push(p.value.split(","));var b=t.find(".chart-data-"+O.style[e]+"-dataname"+i);null!=b&&l.push(b.value.split(","))}O[O.style[e]+"-dataset"]=a,O[O.style[e]+"-names"]=l,O[O.style[e]+"-colors"]=r,O[O.style[e]+"-text-colors"]=0==s.length?r:s}var x=["bar","line"],c=[];for(i=0;i<x.length;i++){for(f=0;f<O.style.length;f++)if(!(0<=c.indexOf(O.style[f]))&&x[i]==O.style[f]){c.push(O.style[f]);break}for(f=0;f<O.style.length;f++)0<=c.indexOf(O.style[f])||c.push(O.style[f])}O.style=c;var y=function(){var t,e,a,l,r,s,i=C.width,o=C.height,n=O.max-O.min,f=O["bar-max"]-O["bar-min"],d=0,h=0,p=function(t){return O["x-prefix"]+t+O["x-postfix"]},b=function(t){return O["y-prefix"]+(isNaN(t)?"-":t)+O["y-postfix"]},x=function(t){return O["bar-y-prefix"]+(isNaN(t)?"-":t)+O["bar-y-postfix"]};R.setTransform(1,0,0,1,0,0),R.lineWidth=.9,R.fillStyle=O.background,R.clearRect(0,0,i,o),R.fillRect(0,0,i,o),R.translate(.5,.5),R.font=O.font,r=R.measureText(b(O.max)),a=t=parseInt(r.width),l=i-8-8-4-parseInt(t)-12,a+=parseInt(l/O.labels.length/2),r=R.measureText(p(O.labels[0])),e=18;for(var c=0;c<O.style.length;c++){if("bar"==O.style[c])h=(y=parseInt(l/O.labels.length/2))/O.bars,r=R.measureText(x(O["bar-max"])),a-=4,i-=(d=parseInt(r.width))+8,l-=d+14}W.baseX=8+t+4+8,W.cellWidth=l/O.labels.length,W.bottom=o-8-e-8,W.top=8,0<O.title.length&&(R.translate(0,20),W.top+=20,o-=20,R.fillStyle="#7c7c7c",R.font=O.titleFont,r=R.measureText(O.title),R.fillText(O.title,i/2-r.width/2,0)),R.font=O.font,R.fillStyle="#8c8c8c",R.strokeStyle=O.gridHorzColor;for(c=0;c<O.labels.length;c++){if(W.index==c){R.fillStyle="rgba(212,212,212,0.17)";var y=parseInt(l*c-l/2)/O.labels.length;R.fillRect(8+a+4+8+y,8,l/O.labels.length,o-8-e-8-8),R.fillStyle="#8c8c8c"}y=p(O.labels[c]);s=(r=R.measureText(y)).width,R.fillText(y,8+a+4+8+l*c/O.labels.length-s/2,o-e+4),y=parseInt((l*c+l/2)/O.labels.length),R.strokeStyle=O.gridVertColor,R.beginPath(),R.moveTo(8+a+4+8+y,12),R.lineTo(8+a+4+8+y,o-8-e-8),R.closePath(),R.stroke(),R.strokeStyle=O.gridHorzColor,R.beginPath(),R.moveTo(8+a+4+8+y,o-8-e-8),R.lineTo(8+a+4+8+y,o-8-e),R.closePath(),R.stroke()}R.beginPath();for(c=0;c<O.splits+1;c++){var g=b(O.max-parseInt((O.max-O.min)*c/O.splits));if(s=(r=R.measureText(g)).width,R.fillText(g,8+t-s,8+(o-8-e)*c/(O.splits+1)+18),c<O.splits&&(g=parseInt((o-8-e)*c/(O.splits+1)),R.moveTo(8+t+4,8+g+14),R.lineTo(i-12,8+g+14)),0<d){g=x(O["bar-max"]-parseInt((O["bar-max"]-O["bar-min"])*c/O.splits));R.fillText(g,i-8,8+(o-8-e)*c/(O.splits+1)+18)}}R.closePath(),R.stroke(),R.strokeStyle=O.baselineColor,R.beginPath(),R.moveTo(8+t+4,o-8-e-8),R.lineTo(i-12,o-8-e-8),R.closePath(),R.stroke(),R.beginPath(),R.moveTo(8+t+4+8,12),R.lineTo(8+t+4+8,o-8-e),0<d&&(R.moveTo(i-8-8-4,12),R.lineTo(i-8-8-4,o-8-e)),R.closePath(),R.stroke();var m=0;R.font=O.popupFont;for(var u=0;u<O.style.length;u++)switch(O.style[u]){case"line":R.lineWidth=1.3;for(c=0;c<O["line-dataset"].length;c++){var v=O["line-dataset"][c];R.strokeStyle=O["line-colors"][c],R.beginPath();for(var T=0;T<v.length;T++){g=(o-e-38)*v[T]/n;0==T?R.moveTo(8+a+4+8+parseInt(l*T/O.labels.length),o-8-e-8-g):R.lineTo(8+a+4+8+parseInt(l*T/O.labels.length),o-8-e-8-g)}R.stroke()}for(c=0;c<O["line-dataset"].length;c++)for(v=O["line-dataset"][c],T=0;T<v.length;T++){y=8+a+4+8+parseInt(l*T/O.labels.length),g=(o-e-38)*v[T]/n;R.lineWidth=1.78,R.strokeStyle=O["line-colors"][c],R.beginPath(),R.arc(y,o-8-e-8-g,3,0,2*Math.PI,!0),R.closePath(),R.stroke(),R.lineWidth=1.3,R.strokeStyle="#FFFFFF",R.beginPath(),R.arc(y,o-8-e-8-g,4.3,0,2*Math.PI,!0),R.closePath(),R.stroke(),R.fillStyle=O["line-colors"][c],R.save(),r=R.measureText(b(v[T])),R.shadowColor="rgba(0, 0, 0, 0.17)",R.shadowOffsetX=0,R.shadowOffsetY=0,R.shadowBlur=7,m=Math.max(r.width,m);var w=o-8-e-8-g+12+8;o-8-e-8<w+10&&(w-=28),R.fillText(b(v[T]),y-parseInt(r.width/2),w),R.restore()}break;case"bar":R.lineWidth=.9;for(c=0;c<O["bar-dataset"].length;c++){v=O["bar-dataset"][c];R.strokeStyle="#727272";for(T=0;T<v.length;T++){y=8+a+4+8+parseInt(l*T/O.labels.length);if("object"==typeof v[T])for(var I=0;I<Math.min(v[T].length,O.bars);I++){R.fillStyle=O["bar-colors"][c][I];g=(o-e-38)*v[T][I]/f;R.fillRect(y-h/2*O.bars+I*h,o-8-e-8-g,h,g),R.strokeRect(y-h/2*O.bars+I*h,o-8-e-8-g,h,g),r=R.measureText(v[T][I]),m=Math.max(r.width,m)}else{R.fillStyle=O["bar-colors"][T][0];g=(o-e-38)*v[T]/f;R.fillRect(y-h/2*O.bars,o-8-e-8-g,h,g),R.strokeRect(y-h/2*O.bars,o-8-e-8-g,h,g),r=R.measureText(v[T]),m=Math.max(r.width,m)}}}}m=parseInt(m);var S=0,k=32,F=18,P=0;for(u=0;u<O.style.length;u++){v=O[O.style[u]+"-dataset"];v=O[O.style[u]+"-names"];for(var M=0;M<v.length;M++)if("object"==typeof v[M]){for(c=0;c<v[M].length;c++)r=R.measureText(v[M][c]),P=Math.max(parseInt(r.width),P);k+=16*v[M].length}else r=R.measureText(v[M]),P=Math.max(parseInt(r.width),P),k+=16*v.length;switch(O.style[u]){case"line":for(c=0;c<O["line-dataset"].length;c++)for(v=O["line-dataset"][c],M=0;M<v.length;M++)if("object"==typeof v[M])for(I=0;I<v[M].length;I++)r=R.measureText(b(v[M][I])),S=Math.max(parseInt(r.width),S);else r=R.measureText(b(v[M])),S=Math.max(parseInt(r.width),S);break;case"bar":for(c=0;c<O["bar-dataset"].length;c++)for(v=O["bar-dataset"][c],M=0;M<v.length;M++)if("object"==typeof v[M])for(I=0;I<Math.min(v[M].length,O.bars);I++)r=R.measureText(b(v[M][I])),S=Math.max(parseInt(r.width),S);else r=R.measureText(b(v[M])),S=Math.max(parseInt(r.width),S)}}S+=(P+=8)+18;for(M=0;M<O.labels.length;M++)if(W.index==M){R.fillStyle="#FFFFFF",R.strokeStyle="#959595";y=parseInt((l*M+l/1.5)/O.labels.length);i-20<=(y+=8+a+4+8)+S&&(y-=parseInt(l/O.labels.length)+S+32),R.save(),R.shadowColor="rgba(0, 0, 0, 0.43)",R.shadowOffsetX=0,R.shadowOffsetY=2,R.shadowBlur=4,R.strokeRect(y,72,S,k),R.restore(),R.fillRect(y,72,S,k),R.fillStyle="#383838",r=R.measureText(O.labels[M]),R.fillText(O.labels[M],y+parseInt(S/2-r.width/2),72+F),F+=20;for(u=0;u<O.style.length;u++)switch(O.style[u]){case"line":for(c=0;c<O["line-dataset"].length;c++){v=O["line-dataset"][c];R.fillStyle="#383838",R.fillText(O["line-names"][c],y+8,72+F),R.fillStyle=O["line-colors"][c],R.fillText(b(v[M]),P+y+8,72+F),F+=16}break;case"bar":R.lineWidth=.9;for(c=0;c<O["bar-dataset"].length;c++){v=O["bar-dataset"][c];if(R.strokeStyle="#727272","object"==typeof v[M])for(I=0;I<Math.min(v[M].length,O.bars);I++)R.fillStyle="#383838",R.fillText(O["bar-names"][c][I],y+8,72+F),R.fillStyle=O["bar-text-colors"][c][I],R.fillText(x(v[M][I]),P+y+8,72+F),F+=16;else R.fillStyle="#383838",R.fillText(O["bar-names"][M],y+8,72+F),R.fillStyle=O["bar-text-colors"][M][0],R.fillText(x(v[M]),P+y+8,72+F),F+=16}}}},g=function(){var t=window.getComputedStyle(C.parentNode,null);C.width=parseInt(t.getPropertyValue("width")),y()};C.addEventListener("mousemove",function(t){var e=W.index;t.offsetY<W.top?W.index=-1:t.offsetY>=W.bottom?W.index=-1:(W.index=Math.floor((t.offsetX-W.baseX)/W.cellWidth),W.index<0?W.index=-1:W.index>=O.labels.length&&(W.index=-1)),e!=W.index&&y()}),C.addEventListener("mouseleave",function(t){W.index=-1,y()}),window.addEventListener("resize",g),g()}}()